{% for author in authors %}
<div class="author-entry">
  <h4 class="inline-header"> {{author.name}} </h4>
  {% if user %}
  <span class="to-hide hidden">
    <small><a href="javascript:" class="edit-author" data-toggle="modal" data-target="#id-modal-author" data-authorname="{{author.name}}" data-authorid="{{author.id}}"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></a></small> 
    <small><a href="javascript:" class="delete-author" data-authorid="{{author.id}}"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></a></small>
  </span>
  {% endif %}
  <p>
    Книги этого автора: 
    {{ author.get_booktitles_list()|join(', ') }}

  </p>
</div>
<hr>
{% endfor %}
<script>

    $(".author-entry").on("mouseover", function() {
      $(this).children(".to-hide").removeClass("hidden");
    });

    $(".author-entry").on("mouseleave", function() {
      $(this).children(".to-hide").addClass("hidden");
    });

  $(document).ready(function(){
    $(".delete-author").on("click", function() {
      var authorid = $(this).attr("data-authorid");
      $.ajax({
        type: "POST",
        url: "/_delete_author",
        data: {authorid: authorid},
        success: function(response){ 
          $("#id-enumerate-books").html(response.books_markup);
          $("#id-enumerate-authors").html(response.authors_markup); 
        },
        error: function(response){
          alert("Error");
        }
      });
    });
  });


  $(".edit-author").on("click", function() {
    $("#id-author-form").attr("data-action", "edit")
    $("#id-input-author-id").val($(this).attr("data-authorid"));

    var authorname = $(this).attr("data-authorname");
    $("#id-input-author-name").val(authorname);
    $("#id-title-author-form").html("Редактировать автора \"" + authorname + "\"");
  });


  $("#id-add-author").on("click", function() {
    $("#id-author-form").attr("data-action", "add");
    $("#id-input-author-id").val("");
    $("#id-input-author-name").val("");
    $("#id-title-author-form").html("Добавить автора");
  });
</script>
