{% for book in books %}
  <h4 class="inline-header"> {{book.title}} </h4>
  <small><a href="javascript:" class="edit-book" data-toggle="modal" data-target="#id-modal-book" data-booktitle="{{book.title}}"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></a></small> 
  <small><a href="javascript:" class="delete-book" data-bookid="{{book.id}}"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></a></small>
  <p>
    Авторы: {{book.get_authornames_list()|join(', ')}}
  </p>
  <hr>
{% endfor %}


<script>
  $(document).ready(function(){
    $(".delete-book").on("click", function() {
      var bookid = $(this).attr("data-bookid");
      $.ajax({
        type: "POST",
        url: "/_delete_book",
        data: {bookid: bookid},
        success: function(response){ 
          $("#id-enumerate-books").html(response.books_markup);
          $("#id-enumerate-authors").html(response.authors_markup); 
        },
        error: function(response){
          alert("Error");
        }
        });
      });
  });

  $(".edit-book").on("click", function() {
    var booktitle = $(this).attr("data-booktitle");
    $("#id-input-book-name").val(booktitle);
    $("#id-title-book-form").html("Редактировать книгу \"" + booktitle + "\"");
  });

  $("#id-add-book").on("click", function() {
    $("#id-input-book-name").val("");
    $("#id-title-book-form").html("Добавить книгу");
    $("#id-input-book-authors").multiselect("deselectAll", false);
    $("#id-input-book-authors").multiselect("updateButtonText");
  })
</script>
